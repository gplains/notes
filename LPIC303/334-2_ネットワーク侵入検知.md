---
title:334-ネットワーク侵入検知
---
# 334-ネットワーク侵入検知

## ntop

- 2014/7ごろに開発終了
 
- 後継とされるntopngはntopとかなり異なる為、RHEL6でしかまともに実験できない
  ```
  # 参考:Ubuntu18.04 でのntopng のインストール手順
  sudo apt install ntopng # 別途redis等web系のモジュールが入る
  ```
 
## snort(2.9系)

 - 303-300ではsnort2.9系を想定している

 -  snort3.0系はコンフィグの保存場所を含めほぼ別物

### Ubuntu18.04の場合

- インストール
  ```
  sudo apt install snort 
  ```

### CentOS7の場合

- インストール
  
  https://snort.org/#get-started を参照
  ```
  yum install https://snort.org/downloads/snort/
  yum install https://snort.org/downloads/snort/snort-2.9.18-1.centos8.x86_64.rpm
  ```

### Snortのオプション

### ルールファイル

### Snort のシグネチャ
  ルールアクション、プロトコル、IPアドレス、ポート番号、方向演算子、IPアドレス、ポート番号
- ルールアクション
- プロトコル 
- IPアドレス
- ポート番号
- 方向演算子
- オプション


## OpenVAS/GVM

- 303-300ではOpenVASが出題されるが、2021/7時点でEOL
- 雰囲気を味わうだけならUbuntu18.04(パターン更新できない)
- 後継のGVMでも一部コマンドは継承しているがopenvas-adduser,openvas-rmuserは存在しない。 gvmd gvm-manage-certs あたりは大体動作は同じ

### Ubuntu 18.04の場合(参考)

- インストール
  ```
  sudo apt install snort 
  ```

- 設定ファイル

  /etc/openvas/openvassd.conf 

### 主なユーティリティ(参考)

| コマンド名            | 用途                              |
| ---------------- | ------------------------------- |
| openvasmd        | OpenVAS Manager 各種操作            |
| openvassd        | OpenVAS Scanner スキャン処理          |
| openvas-nvt-sync | Network Vulnerability Test の更新  |
| openvas-mkcert   | 証明書の作成                                |
| openvas-adduser  | ユーザ追加、openvasmd create-user に同じ |
| openvas-rmuser   | ユーザ削除、openvasmd delete-user に同じ |
|                  |                                 |